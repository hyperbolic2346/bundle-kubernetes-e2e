series: xenial
services:
  "kubernetes-master":
    charm: "cs:~containers/kubernetes-master"
    num_units: 1
    annotations:
      "gui-x": "800"
      "gui-y": "850"
    to:
      - 1
  flannel:
    charm: "cs:~containers/flannel"
    annotations:
      "gui-x": "450"
      "gui-y": "750"
  easyrsa:
    charm: "cs:~containers/easyrsa"
    num_units: 1
    annotations:
      "gui-x": "450"
      "gui-y": "550"
  "kubernetes-worker":
    charm: "cs:~containers/kubernetes-worker"
    num_units: 2
    expose: true
    annotations:
      "gui-x": "100"
      "gui-y": "850"
    constraints: cpu-cores=4 mem=15G root-disk=30G
  etcd:
    charm: "cs:~containers/etcd"
    num_units: 1
    to:
      - "0"
    annotations:
      "gui-x": "800"
      "gui-y": "550"
#    constraints: cpu-cores=2 root-disk=12G
  "kubernetes-e2e":
    charm: "cs:~containers/kubernetes-e2e"
    num_units: 1
    to:
      - "0"
    annotations:
      "gui-x": "1100"
      "gui-y": "850"
relations:
  - - "kubernetes-master:kube-api-endpoint"
    - "kubernetes-worker:kube-api-endpoint"
  - - "kubernetes-master:cluster-dns"
    - "kubernetes-worker:kube-dns"
  - - "kubernetes-master:certificates"
    - "easyrsa:client"
  - - "kubernetes-master:etcd"
    - "etcd:db"
  - - "kubernetes-master:sdn-plugin"
    - "flannel:host"
  - - "kubernetes-worker:certificates"
    - "easyrsa:client"
  - - "kubernetes-worker:sdn-plugin"
    - "flannel:host"
  - - "flannel:etcd"
    - "etcd:db"
  - - "kubernetes-master:kube-api-endpoint"
    - "kubernetes-e2e:kubernetes-master"
  - - "kubernetes-e2e:certificates"
    - "easyrsa:client"
machines:
  "0":
    series: xenial
  "1":
    series: xenial
